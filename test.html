<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="dealerCard">
    </div>
    <div id="card">
    </div>
    <div>
        <button id="pickCard" onclick="addscore()"> 카드 뽑기</button>
        <button id="getResult" onclick="getResult()"> 결과 보기(이판 종료)</button>
        <button id = "gameover" onclick="gameover()">게임 초기화</button>
    </div>

    <script>
        let dealerscore = 0;
        let playerscore = 0;
        let filelist = [
            {"filename" : "2C.png", "score":"2"}, {"filename" : "3C.png", "score":"3"}, {"filename" : "4C.png", "score":"4"}, {"filename" : "5C.png", "score":"5"}, {"filename" : "6C.png", "score":"6"},
            {"filename" : "7C.png", "score":"7"}, {"filename" : "8C.png", "score":"8"}, {"filename" : "9C.png", "score":"9"}, {"filename" : "10C.png", "score":"10"}, {"filename" : "AC.png", "score":"1"},
            {"filename" : "KC.png", "score":"10"}, {"filename" : "QC.png", "score":"10"}, {"filename" : "JC.png", "score":"10"},
            {"filename" : "2D.png", "score":"2"}, {"filename" : "3D.png", "score":"3"}, {"filename" : "4D.png", "score":"4"}, {"filename" : "5D.png", "score":"5"}, {"filename" : "6D.png", "score":"6"},
            {"filename" : "7D.png", "score":"7"}, {"filename" : "8D.png", "score":"8"}, {"filename" : "9D.png", "score":"9"}, {"filename" : "10D.png", "score":"10"}, {"filename" : "AD.png", "score":"1"},
            {"filename" : "KD.png", "score":"10"}, {"filename" : "QD.png", "score":"10"}, {"filename" : "JD.png", "score":"10"},
            {"filename" : "2H.png", "score":"2"}, {"filename" : "3H.png", "score":"3"}, {"filename" : "4H.png", "score":"4"}, {"filename" : "5H.png", "score":"5"}, {"filename" : "6H.png", "score":"6"},
            {"filename" : "7H.png", "score":"7"}, {"filename" : "8H.png", "score":"8"}, {"filename" : "9H.png", "score":"9"}, {"filename" : "10H.png", "score":"10"}, {"filename" : "AH.png", "score":"1"},
            {"filename" : "KH.png", "score":"10"}, {"filename" : "QH.png", "score":"10"}, {"filename" : "JH.png", "score":"10"},
            {"filename" : "2S.png", "score":"2"}, {"filename" : "3S.png", "score":"3"}, {"filename" : "4S.png", "score":"4"}, {"filename" : "5S.png", "score":"5"}, {"filename" : "6S.png", "score":"6"},
            {"filename" : "7S.png", "score":"7"}, {"filename" : "8S.png", "score":"8"}, {"filename" : "9S.png", "score":"9"}, {"filename" : "10S.png", "score":"10"}, {"filename" : "AS.png", "score":"1"},
            {"filename" : "KS.png", "score":"10"}, {"filename" : "QS.png", "score":"10"}, {"filename" : "JS.png", "score":"10"}
        ];





        //-----------------------------------------카드 뽑기-----------------------------------------
        var tempCardList = filelist.map((v)=>{return v;});

        function pickCard(){
            let cardIndex = parseInt(Math.random()*tempCardList.length);
            let cardName = tempCardList[cardIndex];
            tempCardList.splice(cardIndex, 1);
            console.log("player : ", cardName.filename);
            document.getElementById("card").innerHTML += '<img src=52_cards/'+ cardName.filename +' alt="" style="float: left; width: 10%">';
            
            let dealerCardIndex = parseInt(Math.random()*tempCardList.length);
            let dealerCardName = tempCardList[dealerCardIndex];
            tempCardList.splice(dealerCardIndex, 1);
            console.log("dealer : ", dealerCardName.filename);
            document.getElementById("dealerCard").innerHTML += '<img src=52_cards/'+ dealerCardName.filename +' alt="" style="float: right; width: 10%">';
            
            return {"userScore" : cardName.score, "dealerScore" : dealerCardName.score};
        }


        let score = 0;

        //-----------------------------------------게임 오버-----------------------------------------
        //document.getElementById("gameover").addEventListener("click",gameover);
        function gameover(){
            // result();
            document.getElementById("card").innerHTML = "";
            document.getElementById("dealerCard").innerHTML = "";
            document.getElementById("result").innerHTML = "";
            tempCardList = filelist.map((v)=>{return v;});
            playerscore = 0;
            dealerscore = 0;
        }

        //-----------------------------------------score 합치기-----------------------------------------
        function addscore(){
            let oneTime = pickCard();
            dealerscore += parseInt(oneTime.dealerScore);
            playerscore += parseInt(oneTime.userScore);

            if(dealerscore > 21 && playerscore > 21){
                console.log(dealerscore);
                busted("무승부!");
            } else if (dealerscore > 21 && playerscore <= 21) {
                busted("유저 승리!");
            } else if (dealerscore <= 21 && playerscore > 21) {
                busted("딜러 승리!");
            }
        }

        //-----------------------------------------어느 한쪽이라도 버스티드면 이리로 보냄-----------------------------------------
        function busted(result){
            document.getElementById("result").innerText = result;
        }

        //-----------------------------------------결과 계산-----------------------------------------
        function getResult(){
            document.getElementById("result").innerText = " 딜러 : " + dealerscore;
            document.getElementById("result").innerText += " 플레이어 : " + playerscore;
        }
    </script>
</body>
    <div id="result" style="margin-top: 50%;">
    </div>
</html>